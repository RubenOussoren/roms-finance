<div class="space-y-4">
  <div>
    <h2 class="font-medium mb-1">Market Data</h2>
    <p class="text-secondary text-sm mb-4">Alpha Vantage provides security prices and exchange rates.</p>
  </div>

  <div class="mt-4 space-y-4">
    <% if ENV["ALPHA_VANTAGE_API_KEY"].present? %>
      <p class="text-sm text-secondary">You have successfully configured your Alpha Vantage API key through the ALPHA_VANTAGE_API_KEY environment variable.</p>
    <% end %>

    <%= styled_form_with model: Setting.new,
                         url: settings_hosting_path,
                         method: :patch,
                         data: {
                           controller: "auto-submit-form",
                           "auto-submit-form-trigger-event-value": "blur"
                         } do |form| %>
      <%= form.text_field :alpha_vantage_api_key,
                          label: "Alpha Vantage API Key",
                          type: "password",
                          placeholder: "Enter your Alpha Vantage API key",
                          value: ENV.fetch("ALPHA_VANTAGE_API_KEY", Setting.alpha_vantage_api_key),
                          disabled: ENV["ALPHA_VANTAGE_API_KEY"].present?,
                          data: { "auto-submit-form-target": "auto" } %>
    <% end %>

    <p class="text-sm text-secondary">
      Alpha Vantage free tier allows 25 API calls per day. Each security or exchange rate lookup uses 1 call.
      Get a free key at <a href="https://www.alphavantage.co/support/#api-key" target="_blank" class="text-primary underline">alphavantage.co</a>.
    </p>
  </div>
</div>
